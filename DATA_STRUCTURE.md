# Data Structure and File Organization

This document describes the expected data files and directory structure for the repository.

## Required Data Files

### Real-World Analysis (`Real_World/real_data.R`)

The following data files are required in the working directory when running `real_data.R`:

- **`real_world_full_data.rds`**: Full clinical trial dataset containing:
  - Patient IDs
  - Survival times (`time`)
  - Event status (`status`)
  - Dropout indicators (`dropout`)
  - Entry times (`entry_time`)
  - Patient covariates (age, gender, race, KPS, hemoglobin, tumor burden, etc.)
  - Region and IMDC classifications

- **`real_world_mixed_data.rds`**: Mixed-type covariates dataset for clustering:
  - Patient IDs
  - Continuous variables (age, hemoglobin, tumor burden)
  - Categorical variables (gender, race, KPS, disease sites)

### Visualization Scripts

- **`[n]_[k]clus_cluster_labels.csv`**: Cluster assignment results from real-world analysis
  - Contains: `id`, `cluster`, `method`
  - Generated by `real_data.R`

## Output Files

### Simulation Results

Simulation scripts generate the following output files:

1. **Complete Results (RDS format)**:
   - `all_results_s[1-3]_n_[n_total].rds`: Full simulation results including all iterations
   - `all_results_s2_v2[n]_n_[n_total].rds`: Scenario 2 variant results
   - `all_results_by_clus_exp_v2_n_[n_total].rds`: Scenario 1 variant results

2. **Summary Results (CSV format)**:
   - `predict_timepoints_s[1-3]_n_[n_total].csv`: Results aggregated by landmark time
   - `predict_IF_s[1-3]_n_[n_total].csv`: Results aggregated by information fraction
   - `predict_rae_by_clus_exp_v2_n_[n_total].csv`: Scenario 1 RAE results
   - `predict_IF_rae_by_clus_exp_v2_n_[n_total].csv`: Scenario 1 IF results

### Real-World Results

- **`[n]_[k]clus_BIC.csv`**: Prediction metrics for each clustering method
- **`[n]_[k]clus_BIC_v2.csv`**: Updated prediction metrics (if retry logic used)
- **`[n]_[k]clus_cluster_labels.csv`**: Cluster assignments for all methods

## Directory Structure Recommendation

For better organization, consider creating a `data/` directory:

```
data/
├── raw/              # Raw data files (if applicable)
├── processed/          # Processed data files
│   ├── real_world_full_data.rds
│   └── real_world_mixed_data.rds
└── results/            # Analysis results
    ├── simulation/
    └── real_world/
```

**Note**: Currently, scripts expect data files in the same directory as the script. To use a `data/` directory structure, update file paths in the scripts accordingly.

## Data Format Specifications

### Survival Data Format

The survival data should contain:
- `id`: Unique patient identifier
- `time`: Time to event or censoring (from entry)
- `status`: Event indicator (1 = event, 0 = censored)
- `dropout`: Dropout indicator (1 = dropout, 0 = no dropout)
- `entry_time`: Time of study entry (for calendar time calculations)
- `ttf`: Time to failure (absolute calendar time)

### Covariate Data Format

Mixed-type covariates should include:
- **Continuous**: age, hemoglobin, tumor_burden
- **Categorical**: gender, race, kps, disease_sites

All categorical variables should be factors with appropriate levels.

## Notes

- All `.rds` files are R native binary format (use `readRDS()` and `saveRDS()`)
- CSV files use standard comma-separated format
- File naming convention: `[description]_[scenario]_n_[sample_size].[ext]`
- Results files are excluded from version control (see `.gitignore`)
